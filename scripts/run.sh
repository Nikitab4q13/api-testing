#!/bin/bash

# 1. Запуск локального тестирования через Newman
echo " Запуск тестов..."
bash ./run-tests.sh

# Проверка успешности выполнения
if [ $? -eq 0 ]; then
  echo " Тесты прошли успешно. Отправка изменений на GitHub..."

  # 2. Добавление всех изменений (включая родительские папки)
  git add ..

  # 3. Коммит с текущей датой и временем
  git commit -m "Автообновление после успешных тестов: $(date '+%Y-%m-%d %H:%M:%S')"

  # 4. Push в GitHub
  git push origin main

  echo " Изменения отправлены в репозиторий."
else
  echo " Тесты завершились с ошибками. Отправка изменений отменена."
fi
